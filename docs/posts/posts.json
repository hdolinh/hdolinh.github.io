[
  {
    "path": "posts/2021-11-14-stats-final/",
    "title": "1990-2021 data suggests well depth rate is increasing in California",
    "description": "",
    "author": [
      {
        "name": "Halina Do-Linh",
        "url": {}
      }
    ],
    "date": "2021-12-02",
    "categories": [],
    "contents": "\n\nContents\nQuestion\nAre\nwe drilling deeper wells faster over time in California?\n\nData\nData Histograms\n\nAnalysis Plan\nResults\nMultiple Linear\nRegression\nMulitple\nLinear Regression Model with Interaction Effect\nTime Series Analysis\n- Decomposition\n\nFuture Research\nAppendix\nFigures\nReferences\n\n\n\n\nShow code\n\nwells <- read_csv(here::here(\"_posts\", \"2021-11-14-stats-final\",\"data\", \"08_CA_AK.csv\"))\n\n\n\nQuestion\nAre\nwe drilling deeper wells faster over time in California?\n1.5 million people in California rely on domestic well water1. Majority of the 1.5 million reside\nin rural areas without alternative drinking-water sources. Furthermore,\nin the Central Valley, it has been found that one in five wells now run\ndry due to groundwater level declines2. While some have\nresponded to this issue by drilling deeper, this practice has also been\nfound to be unsustainable because it is costly, it is impractical in\ncertain hydrogeological conditions, and deep groundwater is often\nbrackish or saline3. While we are aware that groundwater\nlevels are declining and that deeper drilling is unsustainable, we do\nnot know how fast we are drilling deeper in California over time.\nIt is important to study groundwater trends because water is an\nimportant resource in California and it is crucial for groundwater\nmanagement to be sustainable and equitable. By understanding the rate at\nwhich we are drilling deeper wells over time, we can improve groundwater\nmanagement and make well water a more secure resource, especially for\ncommunities that depend on it.\nData\nMy data was obtained by Dr. Debra Perrone and Dr. Scott Jasechko for\ntheir research on groundwater wells. California domestic well water data\nwas obtained through personal communication with state representatives\nfrom the California Department of Water Resources (CADWR) in March 2016\nand April 2016. The CADWR maintains the California\nGroundwater Well Completion Report database. Dr. Perrone and\nDr. Jasechko reported that the data may contain biases by region, time,\npurpose, and compliance.\nThis data is international, but I subsetted the data to only contain\nwells from California. I also added region codes based on the California Complete Count\nOffice, which groups California’s 58 counties into 10 regions based\non hard-to-count populations, like-mindedness of the counties, capacity\nof community-based organizations within the counties, and state Census\nstaff workload capabilities.\n\n\nShow code\n\nwells_tidy <- wells %>% \n  janitor::clean_names() %>% \n  select(\"well_id\", \"county\", \"purpose_5\", \"date_completed\", \"depth_m\") %>%\n  filter(str_detect(well_id, pattern = \"CA\")) %>% \n  filter(depth_m > -1) %>% \n  mutate(date_completed = lubridate::parse_date_time(date_completed, orders = c(\"mdy\", \"mdy HMS\", \"mdY\"))) %>% \n  mutate(year_completed = lubridate::year(date_completed)) %>% \n  filter(year_completed >= 1900 & year_completed <= 2021)\n\n\n\n\n\nShow code\n\nregion1 <- c(\"Butte\", \"Colusa\", \"El Dorado\", \"Glenn\", \"Lassen\", \"Modoc\", \"Nevada\", \"Placer\", \"Plumas\", \"Sacramento\", \"Shasta\", \"Sierra\", \"Siskiyou\", \"Sutter\", \"Tehama\", \"Yolo\", \"Yuba\")\nregion1_code <- 1\n\nregion2 <- c(\"Del Norte\", \"Humboldt\", \"Lake\", \"Mendocino\", \"Napa\", \"Sonoma\", \"Trinity\")\nregion2_code <- 2\n\nregion3 <- c(\"Alameda\", \"Contra Costa\", \"Marin\", \"San Francisco\", \"San Mateo\", \"Santa Clara\", \"Solano\")\nregion3_code <- 3\n\nregion4 <- c(\"Alpine\", \"Amador\", \"Calaveras\", \"Madera\", \"Mariposa\", \"Merced\", \"Mono\", \"San Joaquin\", \"Stanislaus\", \"Tuolumne\")\nregion4_code <- 4\n\nregion5 <- c(\"Monterey\", \"San Benito\", \"San Luis Obispo\", \"Santa Barbara\", \"Santa Cruz\", \"Ventura\")\nregion5_code <- 5\n\nregion6 <- c(\"Fresno\", \"Inyo\", \"Kern\", \"Kings\", \"Tulare\")\nregion6_code <- 6\n\nregion7 <- c(\"Riverside\", \"San Bernardino\")\nregion7_code <- 7\n\nregion8 <- \"Los Angeles\"\nregion8_code <- 8\n\nregion9 <- \"Orange\"\nregion9_code <- 9\n\nregion10<- c(\"Imperial\", \"San Diego\")\nregion10_code <- 10\n\nwells_region <- wells_tidy %>% \n  mutate(region_code = case_when(county %in% region1 ~ region1_code,\n                                 county %in% region2 ~ region2_code,\n                                 county %in% region3 ~ region3_code,\n                                 county %in% region4 ~ region4_code,\n                                 county %in% region5 ~ region5_code,\n                                 county %in% region6 ~ region6_code,\n                                 county %in% region7 ~ region7_code,\n                                 county %in% region8 ~ region8_code,\n                                 county %in% region9 ~ region9_code,\n                                 county %in% region10 ~ region10_code,\n                                 TRUE ~ 0)) %>% \n  mutate(region_code = as.factor(region_code))\n\n\n\n\n\nShow code\n\nnorcal <- c(1, 2, 3, 4, 5)\nnorcal_code <- \"north\"\n\nsocal <- c(6, 7, 8, 9, 10)\nsocal_code <- \"south\"\n\nregion_north_south <- wells_region %>% \n  mutate(north_south = case_when(region_code %in% norcal ~ norcal_code,\n                                 region_code %in% socal ~ socal_code,\n                                 TRUE ~ \"NA\")) %>%\n  mutate(north_south = as.factor(north_south)) %>% # make north_south a factor variable\n  group_by(year_completed, north_south) %>% \n  mutate(mean_depth_m = mean(depth_m)) # yearly averages by region\n\n\n\nData Histograms\nAfter taking the natural log of well depth (m), it appears to have a\nnormal distribution . It also looks like majority of wells are located\nin Region 1 or Superior California (Figure 1).\n\n\nShow code\n\nlog_depth_m <- log(wells_region$depth_m)\n\ndepth_hist <- ggplot(data = wells_region, aes(log_depth_m)) +\n  geom_histogram(fill = \"light gray\") +\n  labs(x = \"Log of Well Depth (m)\",\n       y = \"Count\",\n       title = \"Well depths (m) in California Transformed by Natural Log (1900-2021)\") +\n  theme_light() +\n  theme(panel.grid = element_blank(),\n        plot.title = element_text(size = 9))\n\n\n\n\n\nShow code\n\n# to color cannot use \"color\" in histogram, need to use \"fill\"\nregion_bar <- ggplot(data = wells_region, aes(x = region_code)) + \n  geom_bar(fill = \"light gray\") +\n  labs(x = \"Region Code\",\n       y = \"Count\",\n       title = \"Distribution of wells by region (1900-2021)\") +\n  theme_light() +\n  theme(panel.grid = element_blank(),\n        plot.title = element_text(size = 9))\n\n\n\n\n\nShow code\n\ndepth_hist / region_bar\n\n\n\n\nFigure 1: Well depth (m) data transformed by natural log\nwere normally distributed (top). Majority of wells in California can be\nfound in Northern regions of California identified here as region codes\n1-5 (bottom).\n\n\n\nExploratory graphs of total counts of wells both over time and by\nregion suggests that overall we are completing less wells (Figure 1).\nHowever, we are also seeing that we could be potentially drilling deeper\nwells over time (Figure 2).\n\n\nShow code\n\nwells_depth_year <- wells_region %>% \n  select(well_id, year_completed, depth_m) %>% \n  group_by(year_completed) %>% \n  summarize(mean_depth_m_year = mean(depth_m))\n\naverage_yr_well_depth_plot <-ggplot(data = wells_depth_year, aes(x = year_completed, y = mean_depth_m_year)) +\n  geom_line() +\n  labs(x = \"Year well was completed\",\n       y = \"Well depth (m)\",\n       title = \"Yearly Average Well Depth (m) from 1990 to 2021\") +\n  theme_light() +\n  theme(panel.grid = element_blank())\n\n\n\n\n\nShow code\n\nwells_counts_year <- wells_region %>% \n  group_by(year_completed) %>% \n  count() %>% \n  rename(\"total_year\" = n)\n\ntot_wells_yr <- ggplot(data = wells_counts_year, aes(x = year_completed, y = total_year)) +\n  geom_line() +\n  labs(x = \"Year well was completed\",\n       y = \"Count\",\n       title = \"Total number of wells per year\") +\n  theme_light() +\n  theme(panel.grid = element_blank())\n\n\n\n\n\nShow code\n\ntot_wells_yr / average_yr_well_depth_plot\n\n\n\n\nFigure 2: Number of wells are appearing to decrease overtime\nin California with a significant drop in 2005 (top). Average well depth\n(m) are appearing to increase overtime in California with a significant\nincrease after 2010 (bottom).\n\n\n\nAnalysis Plan\n1. Regression Analysis\nUse a multiple linear regression model to test if there is an effect\nof time and region on well depth (m), and if there is an effect - find\nwhat is the rate of well depth (m) over time. \\[welldepth(m) =\\beta_{0}+\\beta_{1} \\cdot year_i\n+\\beta_{2} \\cdot region_i+\\varepsilon_i\\]\nI added an interaction effect to my multiple linear regression model\nto see if the effect of year on well depth (m) depends on region. I\npredict there may be deeper wells in the northern regions than the\nsouthern regions since majority of California’s drinking water comes\nfrom northern regions, and that the rate of well depth will be faster in\nthe northern region than the southern region. \\[welldepth(m) =\\beta_{0}+\\beta_{1} \\cdot year_i\n+\\beta_{2} \\cdot region_i+ \\beta_{3} \\cdot year_i \\cdot region_i +\n\\varepsilon_i\\]\n2. Time Series Analysis\nRun decomposition analysis to test for seasonality. From my\nexploratory graphs, I visually saw some evidence of cyclical patterns\n(see Figure 6 in Appendix) and wanted to test to see if this was\nsignificant.\nResults\nMultiple Linear Regression\n\n\nShow code\n\nmod <- lm(mean_depth_m ~ year_completed + north_south, data = region_north_south)\n\nparallel_slopes <- ggplot(data = region_north_south, aes(x = year_completed, y = mean_depth_m,  color = north_south)) +\n  geom_point() +\n  geom_line(data = augment(mod), aes(y = .fitted, color = north_south)) +\n  labs(x = \"Year well was completed\",\n       y = \"Yearly average well depth (m)\") +\n  scale_colour_discrete(\"North South Region\") +\n  theme_light() +\n  theme(panel.grid = element_blank())\nparallel_slopes\n\n\n\n\nFigure 3: Mulitple linear regression model of year and\nregion on well depth. The regression is significant with a p-value <\n0.00000000000000022 at the 0.01 significance level. Adjusted R-squared\nvalue 0.7354648.\n\n\n\nReporting & Interpretation of Coefficients: The\nintercept coefficient tells us that we expect to see a well\ndepth of -292.98 m at year 0 in the south region (this\nis nonsensical). The year_completed coefficient tells us\nthat we expect well depth to increase by 0.178 m each\nyear, holding region constant. The north_south coefficient\ntells us that we expect to see, on average, a 23.85 m\nincrease in well depth in the south region compared to the north region,\nholding year constant.\nOverall Interpretation: This parallel slopes model\ntells us that year, regardless of region, will\nhave the same impact on yearly average well depth (m). This impact is\nsignificant with a p-value of 0.00000000000000022 at the\nsignificance level 0.01. The adjusted r-squared also reports\nthat 74% of the data is explained by year.\nSo over time we are seeing that year is significantly\nincreasing well depth (m) by 0.178 m every year. This\nis a fairly fast rate.\nMulitple\nLinear Regression Model with Interaction Effect\n\n\nShow code\n\nmod_interaction <- lm(mean_depth_m ~ year_completed + north_south + year_completed:north_south, data = region_north_south) \n\ninteraction_plot <- region_north_south %>% \n  ggplot(aes(x = year_completed, y = mean_depth_m, color = north_south)) +\n  geom_point() +\n  geom_line(data = augment(mod_interaction), aes(y = .fitted, color = north_south)) +\n  labs(x = \"Year well was completed\",\n       y = \"Yearly average well depth (m)\") +\n  scale_colour_discrete(\"North South Region\") +\n  theme_light() +\n  theme(panel.grid = element_blank())\ninteraction_plot\n\n\n\n\nFigure 4: Interaction effect of year and region on well\ndepth. The interaction effect is significant with a p-value <\n0.00000000000000022 at the 0.01 significance level. Adjusted R-squared\nvalue is 0.7563347.\n\n\n\nReporting & Interpretation of Coefficients: The\nintercept coefficient tells us that we expect to see a well\ndepth of -493.84 m at year 0 in the north region (this\nis nonsensical). The year_completed coefficient tells us\nthat we expect well depth to increase by 0.27 m each\nyear for a well located in the northern region. The\nnorth_south coefficient tells us that well depths are, on\naverage, 689.50 m deeper in the north region than the\nsouth region at year 0 (this is also nonsensical). The\nyear_completed:north_south coefficient tells us that the\nchange in average well depth (m) after one year for a well in a northern\nregion compared to a well in the southern region is -0.334\nm.\nOverall Interpretation: This interaction effect\ntells us that the relationship between year and\nwell_depth varies with region. This is a\nsignificant effect with a p-value of 0.00000000000000022 at the\nthe significance level 0.01. The adjusted r-squared is reports\nthat 75% of the data is explained by this interaction\neffect. Since this is a slight increase from the adjusted \\(R^2\\) value from the model with no\ninteraction, this tells us that the interaction model improves the model\nfit (at least a little). The rate of the wells being drilled in the\nnorth are at a rate of 0.28 m per year. This is faster\nthan the rate we found without the interaction effect, so we are seeing\nthat not only are we drilling deeper wells faster over time, but that we\nare drilling deeper in northern regions than southern regions over time\nas well.\nTime Series Analysis -\nDecomposition\n\n\nShow code\n\n# created dataset to use as a timeseries object \nmonthly_depth <- region_north_south %>% \n  select(well_id, date_completed, depth_m, region_code, north_south, year_completed) %>% \n  mutate(month_completed = lubridate::month(date_completed)) %>% \n  mutate(month_year_completed = as.yearmon(paste0(year_completed, month_completed), \"%Y %m\")) %>% \n  mutate(month_year_completed = yearmonth(month_year_completed)) %>% \n  group_by(month_year_completed, north_south) %>% \n  mutate(month_mean_depth_m = mean(depth_m)) %>% # monthly averages\n  ungroup()\n\n\n\n\n\nShow code\n\n# classical decomposition analysis \nwells_depth_yearmon <- monthly_depth %>% \n  select(well_id, month_year_completed, depth_m) %>% \n  group_by(month_year_completed) %>% \n  summarize(mean_depth_m_year = mean(depth_m))\n\nwells_tbsl_2 <- as_tsibble(wells_depth_yearmon)\n\nwells_decomp_2 <- wells_tbsl_2 %>% \n  model(classical_decomposition(mean_depth_m_year, type = \"additive\")) %>%\n  components() %>% \n  autoplot()\n\nwells_decomp_2\n\n\n\n\nFigure 5: Decomposition of yearly mean well depth (m) is\nsignificant with trend component, but not with seasonal component\n\n\n\nInterpretation: We see there is evidence of a\nlong-run upward trend over time and there is no\nevidence of seasonality. Based on the size of the bars, the\ntrend component is more important in driving\noverall variation in yearly average well depth (m) since the\ngray bar for trend is much smaller than the bar for the\nseasonal component. This confirmed for me that the “cycles”\nI was seeing in Figure 6 were not significant. It also confirms what we\nalready know: that over time we are drilling deeper wells in\nCalifornia.\nFuture Research\nFuture research could check to see if seasonality is significant in\nonly northern regions. A closer look at Figure 6 shows that most of the\nseasonality is visible in regions one through five, which represent the\nnorthern region. This could make sense, as intuition tells me there\ncould be a more seasonal affect in northern regions due to geology or\ncolder climates.\nOther research could include policy as an independent variable in\nregression or other statistical analysis to see what kind of impact\npolicy has on well drilling depth in California. This would be important\nto look at since we know that a large amount of wells are running dry in\nCalifornia4. And if groundwater levels continue\nto decline, we need to understand what policies are most effective so\nthat we can better manage water now and for the future.\n\nAppendix\nFigures\n\n\nShow code\n\nwells_counts_year_region <- wells_region %>%\n  group_by(region_code, year_completed) %>%\n  count() %>%\n  rename(count = n)\n\ntot_wells_region <- ggplot(data = wells_counts_year_region, aes(x = year_completed, y = count, color = region_code)) +\n  geom_line() +\n  labs(x = \"Year well was completed\",\n       y = \"Number of wells\",\n       title = \"Total number of wells per year by region\",\n       colour = \"Region Code\") +\n  guides(color = guide_legend(nrow = 1)) +\n  theme_light() +\n  theme(\n    panel.grid = element_blank(),\n    legend.position = \"bottom\",\n    legend.title = element_text(size = 7),\n    legend.text = element_text(size = 7))\ntot_wells_region\n\n\n\n\nFigure 6: Total number of wells by region with potential for\ncyclical or seasonal trending.\n\n\n\nReferences\nFull code can be found at my GitHub\nrepository hdolinh.github.io.\n\n\n\nJasechko, Scott, and Debra Perrone. 2020. “California’s Central\nValley Groundwater Wells Run Dry During Recent Drought.”\nEarth’s Future 8. https://doi.org/10.1029/2019EF001339.\n\n\nJohnson, Tyler D., and Kenneth Belitz. 2015. “Identifying the\nLocation and Population Served by Domestic Wells in California.”\nJournal of Hydrology: Regional Studies 3: 31–86. https://doi.org/10.1016/j.ejrh.2014.09.002.\n\n\nPerrone, Debra, and Scott Jasechko. 2019. “Deeper Well Drilling an\nUnsustainable Stopgap to Groundwater Depletion.” Nature\nSustainability 2: 773–82. https://doi.org/10.1038/s41893-019-0325-z.\n\n\nJohnson and Belitz (2015)↩︎\nJasechko and Perrone (2020)↩︎\nPerrone and Jasechko (2019)↩︎\nJasechko and Perrone (2020)↩︎\n",
    "preview": "posts/2021-11-14-stats-final/stats-final_files/figure-html5/unnamed-chunk-5-1.png",
    "last_modified": "2022-06-26T17:02:09-07:00",
    "input_file": {},
    "preview_width": 1056,
    "preview_height": 672
  }
]
