[
  {
    "path": "posts/2021-11-14-stats-final/",
    "title": "Assessing Well Depth in California Between 1990 and 2021",
    "description": "Final project for EDS 222 Environmental Statistics",
    "author": [
      {
        "name": "Halina Do-Linh",
        "url": {}
      }
    ],
    "date": "2021-12-02",
    "categories": [],
    "contents": "\n\n\nShow code\n\nwells <- read_csv(here::here(\"_posts\", \"2021-11-14-stats-final\",\"data\", \"08_CA_AK.csv\"))\n\n#\"MEDS\", \"hdolinh.github.io\"\n\n\n\nQuestion\nAre we drilling deeper wells over time in California?\n1.5 million people in California rely on domestic well water. (Johnson) Majority of the 1.5 million reside in rural areas without alternative drinking-water sources. Furthermore, in the Central Valley, it has been found that one in five wells now run dry due to groundwater level declines (Jasechko 1). While some have responded to this issue by drilling deeper, this practice has also been found to be unsustainable because it is costly, it is impractical in certain hydrogeological conditions, and deep groundwater is often brackish or saline. (Perrone 3) While we are aware that groundwater levels are declining and that deeper drilling is unsustainable, we do not know if this is a long-term trend in California.\nIt is important to study groundwater trends because water is an important resource in California and it is crucial for groundwater management to be sustainable and equitable.\nData\nMy data has been obtained by Dr. Debra Perrone and Dr. Scott Jasechko for their research on groundwater wells. California domestic well water data was obtained through personal communication with state representatives from the California Department of Water Resources (CADWR) in March 2016 and April 2016. The CADWR maintains the California Groundwater Well Completion Report database. Dr. Perrone and Dr. Jasechko reported that the data may contain biases by region, time, purpose, and compliance.\nThis data is international, but I subsetted the data to only contain wells from California. I also added region codes based on the California Complete Count Office, which grouped California’s 58 counties into 10 regions based on hard-to-count populations, like-mindedness of the counties, capacity of community-based organizations within the counties, and state Census staff workload capabilities.\n\n\nShow code\n\nwells_tidy <- wells %>% \n  janitor::clean_names() %>% \n  select(\"well_id\", \"county\", \"purpose_5\", \"date_completed\", \"depth_m\") %>%\n  filter(str_detect(well_id, pattern = \"CA\")) %>% \n  filter(depth_m > -1) %>% \n  mutate(date_completed = lubridate::parse_date_time(date_completed, orders = c(\"mdy\", \"mdy HMS\", \"mdY\"))) %>% \n  mutate(year_completed = lubridate::year(date_completed)) %>% \n  filter(year_completed >= 1900 & year_completed <= 2021)\n\n\n\n\n\nShow code\n\nregion1 <- c(\"Butte\", \"Colusa\", \"El Dorado\", \"Glenn\", \"Lassen\", \"Modoc\", \"Nevada\", \"Placer\", \"Plumas\", \"Sacramento\", \"Shasta\", \"Sierra\", \"Siskiyou\", \"Sutter\", \"Tehama\", \"Yolo\", \"Yuba\")\nregion1_code <- 1\n\nregion2 <- c(\"Del Norte\", \"Humboldt\", \"Lake\", \"Mendocino\", \"Napa\", \"Sonoma\", \"Trinity\")\nregion2_code <- 2\n\nregion3 <- c(\"Alameda\", \"Contra Costa\", \"Marin\", \"San Francisco\", \"San Mateo\", \"Santa Clara\", \"Solano\")\nregion3_code <- 3\n\nregion4 <- c(\"Alpine\", \"Amador\", \"Calaveras\", \"Madera\", \"Mariposa\", \"Merced\", \"Mono\", \"San Joaquin\", \"Stanislaus\", \"Tuolumne\")\nregion4_code <- 4\n\nregion5 <- c(\"Monterey\", \"San Benito\", \"San Luis Obispo\", \"Santa Barbara\", \"Santa Cruz\", \"Ventura\")\nregion5_code <- 5\n\nregion6 <- c(\"Fresno\", \"Inyo\", \"Kern\", \"Kings\", \"Tulare\")\nregion6_code <- 6\n\nregion7 <- c(\"Riverside\", \"San Bernardino\")\nregion7_code <- 7\n\nregion8 <- \"Los Angeles\"\nregion8_code <- 8\n\nregion9 <- \"Orange\"\nregion9_code <- 9\n\nregion10<- c(\"Imperial\", \"San Diego\")\nregion10_code <- 10\n\nwells_region <- wells_tidy %>% \n  mutate(region_code = case_when(county %in% region1 ~ region1_code,\n                                 county %in% region2 ~ region2_code,\n                                 county %in% region3 ~ region3_code,\n                                 county %in% region4 ~ region4_code,\n                                 county %in% region5 ~ region5_code,\n                                 county %in% region6 ~ region6_code,\n                                 county %in% region7 ~ region7_code,\n                                 county %in% region8 ~ region8_code,\n                                 county %in% region9 ~ region9_code,\n                                 county %in% region10 ~ region10_code,\n                                 TRUE ~ 0)) %>% \n  mutate(region_code = as.factor(region_code))\n\n\n\n\n\nShow code\n\nnorcal <- c(1, 2, 3, 4, 5)\nnorcal_code <- \"north\"\n\nsocal <- c(6, 7, 8, 9, 10)\nsocal_code <- \"south\"\n\nregion_north_south <- wells_region %>% \n  mutate(north_south = case_when(region_code %in% norcal ~ norcal_code,\n                                 region_code %in% socal ~ socal_code,\n                                 TRUE ~ \"NA\")) %>%\n  mutate(north_south = as.factor(north_south)) %>% # make north_south a factor variable\n  group_by(year_completed, north_south) %>% \n  mutate(mean_depth_m = mean(depth_m)) # yearly averages by region\n\n\n\nData Histograms\nAfter taking the natural log of well depth (m), it appears to have a normal distribution . It also looks like majority of wells are located in Region 1 or Superior California (Figure 1).\n\n\nShow code\n\nlog_depth_m <- log(wells_region$depth_m)\n\ndepth_hist <- ggplot(data = wells_region, aes(log_depth_m)) +\n  geom_histogram(fill = \"light gray\") +\n  labs(x = \"Log of Well Depth (m)\",\n       y = \"Count\",\n       title = \"Well depths (m) in California Transformed by Natural Log (1900-2021)\") +\n  theme_light() +\n  theme(panel.grid = element_blank(),\n        plot.title = element_text(size = 9))\n\n\n\n\n\nShow code\n\n# to color cannot use \"color\" in histogram, need to use \"fill\"\nregion_bar <- ggplot(data = wells_region, aes(x = region_code)) + \n  geom_bar(fill = \"light gray\") +\n  labs(x = \"Region Code\",\n       y = \"Count\",\n       title = \"Distribution of wells by region (1900-2021)\") +\n  theme_light() +\n  theme(panel.grid = element_blank(),\n        plot.title = element_text(size = 9))\n\n\n\n\n\nShow code\n\ndepth_hist / region_bar\n\n\n\n\nFigure 1: Well depth (m) data transformed by natural log were normally distributed (top). Majority of wells in California can be found in Northern regions of California identified here as region codes 1-5 (bottom).\n\n\n\nExploratory graphs of total counts of wells both over time and by region suggests that overall we are completing less wells (figure 1). However, we are also seeing that we could be potentially drilling deeper wells over time (figure 2).\n\n\nShow code\n\nwells_depth_year <- wells_region %>% \n  select(well_id, year_completed, depth_m) %>% \n  group_by(year_completed) %>% \n  summarize(mean_depth_m_year = mean(depth_m))\n\naverage_yr_well_depth_plot <-ggplot(data = wells_depth_year, aes(x = year_completed, y = mean_depth_m_year)) +\n  geom_line() +\n  labs(x = \"Year well was completed\",\n       y = \"Well depth (m)\",\n       title = \"Yearly Average Well Depth (m) from 1990 to 2021\") +\n  theme_light() +\n  theme(panel.grid = element_blank())\n\n\n\n\n\nShow code\n\nwells_counts_year <- wells_region %>% \n  group_by(year_completed) %>% \n  count() %>% \n  rename(\"total_year\" = n)\n\ntot_wells_yr <- ggplot(data = wells_counts_year, aes(x = year_completed, y = total_year)) +\n  geom_line() +\n  labs(x = \"Year well was completed\",\n       y = \"Count\",\n       title = \"Total number of wells per year\") +\n  theme_light() +\n  theme(panel.grid = element_blank())\n\n\n\n\n\nShow code\n\ntot_wells_yr / average_yr_well_depth_plot\n\n\n\n\nFigure 2: Number of wells are appearing to decrease overtime in California with a significant drop in 2005 (top). Average well depth (m) are appearing to increase overtime in California with a significant increase after 2010 (bottom).\n\n\n\nAnalysis Plan\n1. Regression Analysis\nUse a multiple linear regression model to test if there an affect of time and region on well depth (m). \\[welldepth(m) =\\beta_{0}+\\beta_{1} \\cdot year_i +\\beta_{2} \\cdot region_i+\\varepsilon_i\\]\nI added an interaction effect to my multiple linear regression model to see if the effect of year on well depth (m) depends on region. I predict there may be deeper wells in the northern regions than the southern regions since majority of California’s drinking water comes from northern regions. An interaction effect allows me to test my prediction. \\[welldepth(m) =\\beta_{0}+\\beta_{1} \\cdot year_i +\\beta_{2} \\cdot region_i+ \\beta_{3} \\cdot year_i \\cdot region_i + \\varepsilon_i\\]\n2. Time Series Analysis\nRun decomposition analysis to test for seasonality. From my exploratory graphs I visually saw some evidence of cyclical patterns (see Figure 6 in Appendix) and wanted to see if this was significant.\n\n\nShow code\n\nwells_counts_year_region <- wells_region %>% \n  group_by(region_code, year_completed) %>% \n  count() %>% \n  rename(count = n)\n\nwells_counts_year_region_plot <- ggplot(data = wells_counts_year_region, aes(x = year_completed, y = count, color = region_code)) +\n  geom_line() +\n  labs(x = \"Year well was completed\",\n       y = \"Number of wells\",\n       title = \"Total number of wells per year by region\",\n       colour = \"Region Code\") +\n  guides(color = guide_legend(nrow = 1)) +\n  theme_light() +\n  theme(\n    panel.grid = element_blank(),\n    legend.position = \"bottom\"\n  )\n\n\n\nResults\nMultiple Linear Regression\n\n\nShow code\n\nmod <- lm(mean_depth_m ~ year_completed + north_south, data = region_north_south)\n\nparallel_slopes <- ggplot(data = region_north_south, aes(x = year_completed, y = mean_depth_m,  color = north_south)) +\n  geom_point() +\n  geom_line(data = augment(mod), aes(y = .fitted, color = north_south)) +\n  labs(x = \"Year well was completed\",\n       y = \"Yearly average well depth (m)\") +\n  scale_colour_discrete(\"North South Region\") +\n  theme_light() +\n  theme(panel.grid = element_blank())\nparallel_slopes\n\n\n\n\nFigure 3: Mulitple linear regression model of year and region on well depth. P-value < 0.00000000000000022. Adjusted R-value 0.7354648.\n\n\n\nInterpretation: The intercept coefficient tells us that we expect to see a well depth of -292.98 m at year 0 in the south region (this is nonsensical). The year_completed coefficient tells us that we expect well depth to increase by 0.178 m each year, holding region constant. The north_south coefficient tells us that we expect to see, on average, a 23.85 m increase in well depth in the south region compared to the north region, holding year constant.\nThis parallel slopes model tells us that year, regardless of region, will have the same impact on yearly average well depth (m).\nMulitple Linear Regression Model with Interaction Effect\n\n\nShow code\n\nmod_interaction <- lm(mean_depth_m ~ year_completed + north_south + year_completed:north_south, data = region_north_south) \n\ninteraction_plot <- region_north_south %>% \n  ggplot(aes(x = year_completed, y = mean_depth_m, color = north_south)) +\n  geom_point() +\n  geom_line(data = augment(mod_interaction), aes(y = .fitted, color = north_south)) +\n  labs(x = \"Year well was completed\",\n       y = \"Yearly average well depth (m)\") +\n  scale_colour_discrete(\"North South Region\") +\n  theme_light() +\n  theme(panel.grid = element_blank())\ninteraction_plot\n\n\n\n\nFigure 4: Interaction effect of year and region on well depth. P-value < 0.00000000000000022. Adjusted R-value 0.7563347\n\n\n\nInterpretation: The intercept coefficient tells us that we expect to see a well depth of -493.84 m at year 0 in the north region (this is nonsensical). The year_completed coefficient tells us that we expect well depth to increase by 0.27 m each year for a well located in the northern region. The north_south coefficient tells us that well depths are, on average, 689.50 m deeper in the north region than the south region at year 0 (this is also nonsensical). The year_completed:north_south coefficient tells us that year on yearly average well depth (m) is 0.33 higher in the southern region than the northern region. The relationship between year and well_depth varies with region.\nAdditionally, since the adjusted \\(R^2\\) value increased slightly, this tells us that the interaction model improves the model fit a little. This indicates that north_south adding value to the model.\nTime Series Analysis - Decomposition\n\n\nShow code\n\n# created dataset to use as a timeseries object \nmonthly_depth <- region_north_south %>% \n  select(well_id, date_completed, depth_m, region_code, north_south, year_completed) %>% \n  mutate(month_completed = lubridate::month(date_completed)) %>% \n  mutate(month_year_completed = as.yearmon(paste0(year_completed, month_completed), \"%Y %m\")) %>% \n  mutate(month_year_completed = yearmonth(month_year_completed)) %>% \n  group_by(month_year_completed, north_south) %>% \n  mutate(month_mean_depth_m = mean(depth_m)) %>% # monthly averages\n  ungroup()\n\n\n\n\n\nShow code\n\n# classical decomposition analysis \nwells_depth_yearmon <- monthly_depth %>% \n  select(well_id, month_year_completed, depth_m) %>% \n  group_by(month_year_completed) %>% \n  summarize(mean_depth_m_year = mean(depth_m))\n\nwells_tbsl_2 <- as_tsibble(wells_depth_yearmon)\n\nwells_decomp_2 <- wells_tbsl_2 %>% \n  model(classical_decomposition(mean_depth_m_year, type = \"additive\")) %>%\n  components() %>% \n  autoplot()\n\nwells_decomp_2\n\n\n\n\nFigure 5: Decomposition of yearly mean well depth (m) with significance with trend, but not seasonal.\n\n\n\nInterpretation: - trend: We see that trend is adding value to the model. - seasonal: We do not see that seasonal is adding value to the model. - random: We see that random is adding value to the model. - mean_depth_m_year: We see that mean_depth_m_year is adding value to the model.\nFuture Research\nFuture research would check to see if seasonality is present with just northern regions.\nAppendix\nFigures\n\n\nShow code\n\nwells_counts_year_region <- wells_region %>%\n  group_by(region_code, year_completed) %>%\n  count() %>%\n  rename(count = n)\n\ntot_wells_region <- ggplot(data = wells_counts_year_region, aes(x = year_completed, y = count, color = region_code)) +\n  geom_line() +\n  labs(x = \"Year well was completed\",\n       y = \"Number of wells\",\n       title = \"Total number of wells per year by region\",\n       colour = \"Region Code\") +\n  guides(color = guide_legend(nrow = 1)) +\n  theme_light() +\n  theme(\n    panel.grid = element_blank(),\n    legend.position = \"bottom\",\n    legend.title = element_text(size = 7),\n    legend.text = element_text(size = 7))\ntot_wells_region\n\n\n\n\nFigure 6: Total number of wells by region with potential for cyclical or seasonal trending.\n\n\n\nReferences\nJasechko, Scott, and Debra Perrone. “California’s Central Valley Groundwater Wells Run Dry During Recent Drought.” Earth’s Future, vol. 8, no. 4, Apr. 2020. DOI.org (Crossref), https://doi.org/10.1029/2019EF001339.\nJohnson, Tyler D., and Kenneth Belitz. “Identifying the Location and Population Served by Domestic Wells in California.” Journal of Hydrology: Regional Studies, vol. 3, Mar. 2015, pp. 31–86. DOI.org (Crossref), https://doi.org/10.1016/j.ejrh.2014.09.002.\nPerrone, Debra, and Scott Jasechko. “Deeper Well Drilling an Unsustainable Stopgap to Groundwater Depletion.” Nature Sustainability, vol. 2, no. 8, Aug. 2019, pp. 773–82. DOI.org (Crossref), https://doi.org/10.1038/s41893-019-0325-z.\n\n\n\n",
    "preview": "posts/2021-11-14-stats-final/stats-final_files/figure-html5/unnamed-chunk-2-1.png",
    "last_modified": "2021-12-01T07:58:42-08:00",
    "input_file": {}
  },
  {
    "path": "posts/2021-08-10-a-function-i-learned/",
    "title": "A function I learned",
    "description": "A short description of the post.",
    "author": [
      {
        "name": "Halina Do-Linh",
        "url": {}
      }
    ],
    "date": "2021-08-10",
    "categories": [],
    "contents": "\nDistill is a publication format for scientific and technical writing, native to the web.\nLearn more about using Distill at https://rstudio.github.io/distill.\n\n\n\n",
    "preview": {},
    "last_modified": "2021-11-14T11:17:45-08:00",
    "input_file": {}
  },
  {
    "path": "posts/2021-08-10-my-first-blog-post/",
    "title": "My First Blog Post",
    "description": "A short description of the post.",
    "author": [
      {
        "name": "Halina Do-Linh",
        "url": {}
      }
    ],
    "date": "2021-08-10",
    "categories": [],
    "contents": "\nDistill is a publication format for scientific and technical writing, native to the web.\nLearn more about using Distill at https://rstudio.github.io/distill.\n\n\n\n",
    "preview": {},
    "last_modified": "2021-11-14T11:18:03-08:00",
    "input_file": {}
  }
]
